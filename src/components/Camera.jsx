import { createElement, useState } from "react";
import { CameraName, CameraNotFound, CameraWrapper } from "./Camera.styles";
import Indicator from "./Indicator";

import cameraWhiteSvg from "../images/camerawhite.svg";

const Camera = ({ children, url = null, active = false }) => {
	const [isActive, setActive] = useState(active);
	const [time, setTime] = useState(Date.now());

	const onError = () => {
		setTime(Date.now());
		setActive(false);
	};

	const onLoad = () => {
		setActive(true);
	};

	if (!url && isActive) {
		setActive(false);
	}

	return (
		<CameraWrapper>
			<CameraName>
				<Indicator activated={isActive} image={cameraWhiteSvg}>
					{children}
				</Indicator>
			</CameraName>
			{url ? (
				<img
					src={url + "?time=" + time}
					onError={onError}
					onLoad={onLoad}
				/>
			) : (
				<CameraNotFound>
					<svg
						width="150"
						height="150"
						viewBox="0 0 150 150"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							fillRule="evenodd"
							clipRule="evenodd"
							d="M38.1442 90.6134L4.16731 124.585C1.45266 127.424 -0.0428506 131.212 0.00093504 135.14C0.0447207 139.067 1.62433 142.821 4.40159 145.598C7.17884 148.376 10.933 149.955 14.8604 149.999C18.7878 150.043 22.5763 148.547 25.4148 145.833L59.3866 111.856C68.6279 117.323 79.1711 120.199 89.9082 120.184C123.074 120.184 150 93.2574 150 60.0918C150 26.9261 123.074 0 89.9082 0C56.7426 0 29.8165 26.9261 29.8165 60.0918C29.8165 71.2288 32.8511 81.6597 38.1442 90.6134ZM44.0332 98.886L11.2531 131.666C10.3142 132.605 9.78665 133.879 9.78665 135.206C9.78665 136.534 10.3142 137.808 11.2531 138.747C12.1921 139.686 13.4656 140.213 14.7935 140.213C16.1215 140.213 17.395 139.686 18.3339 138.747L51.114 105.967C48.5601 103.809 46.1915 101.44 44.0332 98.886ZM89.9082 10.0153C117.545 10.0153 139.985 32.4546 139.985 60.0918C139.985 87.729 117.545 110.168 89.9082 110.168C62.271 110.168 39.8318 87.729 39.8318 60.0918C39.8318 32.4546 62.271 10.0153 89.9082 10.0153ZM89.9082 20.0306C67.7995 20.0306 49.8471 37.983 49.8471 60.0918C49.8471 82.2005 67.7995 100.153 89.9082 100.153C112.017 100.153 129.969 82.2005 129.969 60.0918C129.969 37.983 112.017 20.0306 89.9082 20.0306ZM89.9082 30.0459C106.489 30.0459 119.954 43.5114 119.954 60.0918C119.954 76.6721 106.489 90.1376 89.9082 90.1376C73.3279 90.1376 59.8624 76.6721 59.8624 60.0918C59.8624 43.5114 73.3279 30.0459 89.9082 30.0459ZM82.8274 60.0918L76.3525 66.5666C75.4404 67.5111 74.9356 68.776 74.947 70.089C74.9584 71.402 75.4851 72.658 76.4135 73.5865C77.342 74.5149 78.598 75.0416 79.911 75.053C81.224 75.0644 82.4889 74.5596 83.4334 73.6475L89.9082 67.1726L96.3831 73.6475C97.3276 74.5596 98.5925 75.0644 99.9055 75.053C101.219 75.0416 102.474 74.5149 103.403 73.5865C104.331 72.658 104.858 71.402 104.869 70.089C104.881 68.776 104.376 67.5111 103.464 66.5666L96.989 60.0918L103.464 53.6169C104.376 52.6724 104.881 51.4075 104.869 50.0945C104.858 48.7815 104.331 47.5255 103.403 46.5971C102.474 45.6686 101.219 45.142 99.9055 45.1305C98.5925 45.1191 97.3276 45.6239 96.3831 46.5361L89.9082 53.0109L83.4334 46.5361C82.4889 45.6239 81.224 45.1191 79.911 45.1305C78.598 45.142 77.342 45.6686 76.4135 46.5971C75.4851 47.5255 74.9584 48.7815 74.947 50.0945C74.9356 51.4075 75.4404 52.6724 76.3525 53.6169L82.8274 60.0918Z"
							fill="black"
						/>
					</svg>
					<h4>Webcam's gone incognito. Check back later.</h4>
				</CameraNotFound>
			)}
		</CameraWrapper>
	);
};

export default Camera;
